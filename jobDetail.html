<!DOCTYPE html>
<html>

<head>
<meta charset='UTF-8'>
<title>Job Detail</title>
<link rel="stylesheet" href="/static/css/style.css">

<script type="text/javascript" src="static/scripts/jquery.min.js"></script>
<script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
<script type="text/javascript" src="static/scripts/myTable.js"></script>
<script type="text/javascript" src="static/scripts/myList.js"></script>
<script type="text/javascript">

$(document).ready(function(){{
    //create table job_table and part_table
    var j_info         = {job_info}
    var j_h_titles     = {{'JobID':'Job ID', 'JobName':'Name','AllocCPUS':'Alloc CPU','State':'State','ExitCode':'Exit Code','NodeList':'Alloc Node','Start':'Start','End':'End'}}
    var type_dict      = {{'JobIDRaw':'JobAndStep'}}
    if (("ArrayJobID" in j_info) || ('HeterogeneousJobID' in j_info)) 
       j_h_titles     = {{'JobIDRaw':'Job ID', 'JobID':'Job ID(Report)', 'JobName':'Name','AllocCPUS':'Alloc CPU','State':'State','ExitCode':'Exit Code','NodeList':'Alloc Node','Start':'Start','End':'End'}}
    if ({worker_proc}) {{
       createMultiTable ({worker_proc}, 'div_worker_proc', {title_list}, {job_id})
    }}

    createList  (j_info,  {{'State':'State','User':'User','QOS':'QOS','ReqTRES':'Req TRES','AllocTRES':'Alloc TRES','Eligible':'Eligible Time','Start':'Start Time', 'End':'End Time','CPUTime':'CPU Time','WorkDir':'Work Dir','ExitCode':'Exit Code','ArrayJobID':'Array Job','HeterogeneousJobID':'Heterogeneous Job'}}, '#job_info', {{'ReqTRES':'TresShort','AllocTRES':'TresShort'}})
    createTable ({job_report}, j_h_titles,  'job_history_table', 'job_report', undefined, {{'JobID':'JobAndStep'}})
    $("#node_cnt").text(j_info['AllocNodes'])
    $("#cpu_cnt").text(j_info['AllocCPUS'])
    $('.table_title').click(function(event) {{
       //$(this).children("i").toggleClass('hide')
       $(this).toggleClass('table_title_collapse')
       $(this).next().toggleClass('hide')
    }});

    if (j_info['AllocGRES'])
       $("#extra_link").html(", <a href='jobGPUGraph?jid=" + {job_id} + "'>GPU Usage Graph</a>")

}});
</script>
</head>

<body>
<div id="user" class="page-wrap">
<h3 id="title"> 
  Job {job_id}: <a href='./jobByName?name={job_name}'>{job_name}</a> (<a href='jobGraph?jobid={job_id}'>Usage Graph</a><font id='extra_link'></font>)</h3>
<p><i>Update time: {update_time}</i>
<hr>
</div>
<div id="job_info">
</div>
<div id="div_worker_proc" class="page-wrap">
   <h3>Total {proc_cnt} Processes on <font id="node_cnt"></font> Allocated Nodes and <font id="cpu_cnt"></font> Cores</h3>
   <div><font color='orange'>{note}</font></div>
</div>
<div id="job_report" class="page-wrap">
   <h3>Job Report</h3>
</div>
</body>

</html>
